<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Adamâ€™s</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Adamâ€™s" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://adam8157.info/" />
<meta property="og:url" content="https://adam8157.info/" />
<meta property="og:site_name" content="Adamâ€™s" />
<meta property="og:type" content="website" />
<link rel="next" href="https://adam8157.info/blog/page2/" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Adamâ€™s" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","headline":"Adamâ€™s","name":"Adamâ€™s","url":"https://adam8157.info/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://adam8157.info/feed.xml" title="Adam&apos;s" /><link rel="alternate" type="application/rss+xml" title="Adam's" href="https://feeds.feedburner.com/adam8157">
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Adam&#39;s</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/blog/archives/">Archives</a><a class="page-link" href="https://feeds.feedburner.com/adam8157">RSS</a>
        </div>
      </nav></div>
</header>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-927EWG9EGB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-927EWG9EGB');
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  
    <p class="date">
      <span>Nov 22, 2019</span>
    </p>

    <h1><a href="/blog/2019/11/why-does-offlineimap-not-work-with-launchd/">Why does offlineimap not work with launchd</a></h1>

    <div class="content">
      <p><strong>TL;DR, donâ€™t place your Maildir into Documents, Downloads or Desktop.</strong></p>

<p>Iâ€™m a heavy user of offlineimap. Thanks to Homebrew, which provides a quite nice plist (which stands for â€œproperty listâ€) file for macOSâ€™s launchd to start the service at login, the offlineimap always works well until macOS <del>Vista</del> Catalina.</p>

<p>Days ago, after I upgraded the system to Catalina, offlineimap stopped working, no new mails got in at all. Although I appreciate the break, itâ€™s a thing need to be fixed.</p>

<ol>
  <li>Run <code class="language-plaintext highlighter-rouge">offlineimap -o</code> directly, good, so itâ€™s a launchd thing.</li>
  <li>Enable the launchd logging, it reports â€œOperation not permittedâ€ when <code class="language-plaintext highlighter-rouge">os.listdir()</code>, what?</li>
  <li>Check the UID, it has the permission.</li>
  <li>Check the effective UID, itâ€™s the same as the UID.</li>
</ol>

<p>After almost two hoursâ€™ searching, I got nothing interesting and went back to think â€œWhy does it not work after upgrading to Catalina?â€</p>

<p>The answer is right in <a href="https://developer.apple.com/documentation/macos_release_notes/macos_catalina_10_15_release_notes">macOS Catalina Release Notes</a>:</p>

<blockquote>
  <p>Launch daemons and launch agents introduce new user privacy protections. Specifying privacy-sensitive files and folders in a launchd property list might not work as expected and prevent the service from running.</p>
</blockquote>

<p>ğŸ™„ Good work, Apple.</p>

    </div>

    <br />
  
    <p class="date">
      <span>Jun 30, 2018</span>
    </p>

    <h1><a href="/blog/2018/06/jump-consistent-hash-explained/">Jump consistent hashç®—æ³•åˆ†æ</a></h1>

    <div class="content">
      <p><a href="https://arxiv.org/pdf/1406.2294.pdf" title="è®ºæ–‡é“¾æ¥">Jump Consistent Hash</a>æ˜¯ä¸€ä¸ªæ¥è‡ªGoogleçš„å¿«é€Ÿ, å‡ ä¹æ²¡æœ‰å†…å­˜æ¶ˆè€—çš„ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•. è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘çš„ç¿»è¯‘å’Œç†è§£æ€è·¯.</p>

<h2 id="å“ˆå¸Œç®—æ³•çš„è®¾è®¡ç›®æ ‡">å“ˆå¸Œç®—æ³•çš„è®¾è®¡ç›®æ ‡</h2>

<ol>
  <li>å¹³è¡¡æ€§, æŠŠå¯¹è±¡å‡åŒ€åœ°åˆ†å¸ƒåœ¨æ‰€æœ‰æ¡¶(bucket)ä¸­.</li>
  <li>å•è°ƒæ€§, å½“æ¡¶çš„æ•°é‡å˜åŒ–æ—¶, åªéœ€è¦æŠŠä¸€äº›å¯¹è±¡ä»æ—§æ¡¶ç§»åŠ¨åˆ°æ–°æ¡¶, ä¸éœ€è¦åšå…¶å®ƒ(ä¾‹å¦‚æ—§æ¡¶ä¹‹é—´çš„)ç§»åŠ¨.</li>
</ol>

<p>æ¯”å¦‚ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨çš„ç³»ç»Ÿ, æŒ‰å“ˆå¸Œåˆ†å¸ƒå¸¦æ¥ä¼˜åŒ–çš„ä¾¿åˆ©, å¹³è¡¡æ€§å¯ä»¥é¿å…æ•°æ®å€¾æ–œ, å•è°ƒæ€§åˆ™ä½¿å¾—æ‰©å®¹å’Œå‡å®¹æ›´å¿«é€Ÿ.</p>

<h2 id="ç®—æ³•çš„è®¾è®¡æ€è·¯">ç®—æ³•çš„è®¾è®¡æ€è·¯</h2>

<p>æˆ‘ä»¬ç”¨å¾ªåºæ¸è¿›çš„æ€è·¯æ¥è®¾è®¡, <code class="language-plaintext highlighter-rouge">ch(key, num_buckets)</code>ä¸ºæ¡¶æ•°ä¸ºnum_bucketsæ—¶çš„hashå‡½æ•°, ä¸ºäº†æ»¡è¶³è®¾è®¡ç›®æ ‡, éœ€è¦:</p>

<ol>
  <li>num_bucketsä¸º1æ—¶, ä»»æ„key, <code class="language-plaintext highlighter-rouge">ch(key, 1)==0</code>, å…¨è½åœ¨ç¬¬0ä¸ªæ¡¶é‡Œ.</li>
  <li>num_bucketsç”±1<strong>å˜ä¸º</strong>2å, <code class="language-plaintext highlighter-rouge">ch(key, 2)</code>åº”è¯¥æœ‰1/2çš„ç»“æœä¿æŒä¸º0, æœ‰1/2å˜ä¸º1.</li>
  <li>â€¦</li>
  <li>num_bucketsç”±n<strong>å˜ä¸º</strong>n+1å, <code class="language-plaintext highlighter-rouge">ch(key, n+1)</code>åº”è¯¥æœ‰n/(n+1)çš„ç»“æœä¿æŒä¸å˜, æœ‰1/(n+1)è·³å˜ä¸ºn+1.</li>
</ol>

<p>å› æ­¤, åªè¦æˆ‘ä»¬ç”¨ä¸€ä¸ªåˆ†å¸ƒå‡åŒ€çš„å‡½æ•°, ä¾‹å¦‚ä¼ªéšæœºæ•°ç”Ÿæˆå™¨, å¹¶ä¸”è®©è¿™ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„çŠ¶æ€åªä¾èµ–äºkey, ä»0ä¸ªæ¡¶å¼€å§‹æ¨å¯¼, å˜åˆ°ç¬¬num_bucketsä¸ªæ¡¶, ç»“æœå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„hashå€¼:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int ch(int key, int num_buckets) {
    random.seed(key);
    int b = 0;
    for (int j = 1; j &lt; num_buckets; j++) {
        if (random.next() &lt; 1.0 / (j + 1))
            b = j;
    }
    return b;
}
</code></pre></div></div>

<p>å¾ˆæ˜¾ç„¶, è¿™ä¸ªç®—æ³•æ˜¯O(n)çš„, è€Œä¸”éšç€<code class="language-plaintext highlighter-rouge">j</code>è¶Šæ¥è¶Šå¤§, <code class="language-plaintext highlighter-rouge">b=j</code>éœ€è¦æ‰§è¡Œçš„æ¦‚ç‡ä¹Ÿè¶Šæ¥è¶Šä½. Googleæœ€ç»ˆçš„ç®—æ³•å«<strong>Jump</strong> Consistent Hash, JumpæŒ‡çš„æ˜¯<code class="language-plaintext highlighter-rouge">j</code>æ˜¯è·³è·ƒçš„, é‚£ä»–ä»¬æ˜¯æ€ä¹ˆè®©<code class="language-plaintext highlighter-rouge">j</code>è·³è·ƒ, å¹¶ä¿æŒç»“æœæ­£ç¡®å‘¢?</p>

<p>æˆ‘ä»¬ç”¨æ¦‚ç‡çš„æ€è·¯æ¥æƒ³è¿™ä¸ªé—®é¢˜, å‡è®¾å˜åŒ–è¿‡ç¨‹ä¸­çš„ä¸Šä¸€æ¬¡ç»“æœæ˜¯<code class="language-plaintext highlighter-rouge">b</code>, ä¸‹ä¸€æ¬¡ç»“æœ<code class="language-plaintext highlighter-rouge">j</code>å¤§äºç­‰äºä¸€ä¸ªå¤§äº<code class="language-plaintext highlighter-rouge">b</code>çš„æ•°<code class="language-plaintext highlighter-rouge">i</code>çš„æ¦‚ç‡, ä¹Ÿå°±æ˜¯<strong>å¯ä»¥è·³åˆ°<code class="language-plaintext highlighter-rouge">i</code>çš„æ¦‚ç‡</strong>, ä¹Ÿå°±æ˜¯ä»<code class="language-plaintext highlighter-rouge">b+1</code>åˆ°<code class="language-plaintext highlighter-rouge">i</code>çš„è¿‡ç¨‹ä¸­, æ¡¶åºå·éƒ½æ²¡æœ‰å˜çš„æ¦‚ç‡ä¸º:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(j&gt;=i) = P(ch(key, b+1)==ch(key, i))
</code></pre></div></div>

<p>è¿™ä¸ªæ¦‚ç‡ä¹Ÿå°±æ˜¯è¿ç»­å¤šæ¬¡ä¸å˜äº‹ä»¶æ¦‚ç‡çš„ä¹˜ç§¯:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(j&gt;=i) = P(ch(key, b+1)==ch(k, b+2)) * P(ch(key, b+2)==ch(key, b+3)) * ... * P(ch(key, i-1)==ch(key, i))
</code></pre></div></div>

<p>ç”±äºå•æ¬¡ä¸å˜çš„æ¦‚ç‡ä¸º:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(ch(key, i)==ch(key, i+1)) = i/(i+1)
</code></pre></div></div>

<p>æ‰€ä»¥è¿ç»­å¤šæ¬¡ä¸å˜çš„æ¦‚ç‡ä¸º:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(j&gt;=i) = (b+1)/(b+2) * (b+2)/(b+3) * ... * (i-1)/i = (b+1)/i
</code></pre></div></div>

<p>åŸºäºä¹‹å‰çš„ä»£ç , å½“éšæœºç»“æœ<code class="language-plaintext highlighter-rouge">r</code>å°äº<code class="language-plaintext highlighter-rouge">(b+1)/i</code>æ—¶è·³åˆ°<code class="language-plaintext highlighter-rouge">i</code>å°±å¯ä»¥ä¿æŒæ¦‚ç‡ä¸å˜, ä¹Ÿå°±æ˜¯ä»»æ„çš„<code class="language-plaintext highlighter-rouge">r</code>éƒ½å¯ä»¥è·³åˆ°<code class="language-plaintext highlighter-rouge">floor((b+1)/r)</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int ch(int key, int num_buckets) {
    random.seed(key);
    int b = -1;
    int j = 0;
    while (j &lt; num_buckets) {
        b = j;
        double r = random.next();
        j = floor((b + 1) / r);
    }
    return b;
}
</code></pre></div></div>

<h2 id="æœ€ç»ˆçš„å®Œæ•´ä»£ç ">æœ€ç»ˆçš„å®Œæ•´ä»£ç </h2>

<p>æœ€ç»ˆä»£ç é‡Œæ²¡æœ‰ç”¨randomå‡½æ•°, è€Œæ˜¯å†™äº†ä¸€ä¸ªåŸºäºâ€çº¿æ€§åŒä½™æ–¹æ³•â€çš„ä¼ªéšæœºæ•°äº§ç”Ÿå™¨, æ„æ€æ˜¯ä¸€æ ·çš„.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int32_t JumpConsistentHash(uint64_t key, int32_t num_buckets) {
    int64_t b = -1, j = 0;
    while (j &lt; num_buckets) {
        b = j;
        key = key * 2862933555777941757ULL + 1;
        j = (b + 1) * (double(1LL &lt;&lt; 31) / double((key &gt;&gt; 33) + 1));
    }
    return b;
}
</code></pre></div></div>

    </div>

    <br />
  
    <p class="date">
      <span>May 31, 2018</span>
    </p>

    <h1><a href="/blog/2018/05/how-greenplum-plans-a-join/">How Greenplum plans a JOIN</a></h1>

    <div class="content">
      <h2 id="what-is-a-join">What is a â€œJOINâ€</h2>

<p>INNER JOIN is an <strong>AND</strong>, OUTER JOIN is an <strong>OR</strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id name       id  name
-- ----       --  ----
1  Pirate     1   Rutabaga
2  Monkey     2   Pirate
3  Ninja      3   Darth Vader
4  Spaghetti  4   Ninja
</code></pre></div></div>

<p>INNER JOINâ€™s results are those tuples in table A <strong>AND</strong> B.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># SELECT * FROM TableA
INNER JOIN TableB
ON TableA.name = TableB.name;

 id |  name  | id |  name
----+--------+----+--------
  3 | Ninja  |  4 | Ninja
  1 | Pirate |  2 | Pirate
(2 rows)
</code></pre></div></div>

<p>FULL [OUTER] JOINâ€™s results are those tuples in table A <strong>OR</strong> B.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># SELECT * FROM TableA
FULL OUTER JOIN TableB
ON TableA.name = TableB.name;
 id |   name    | id |    name
----+-----------+----+-------------
  3 | Ninja     |  4 | Ninja
    |           |  3 | Darth Vader
  2 | Monkey    |    |
  1 | Pirate    |  2 | Pirate
    |           |  1 | Rutabaga
  4 | Spaghetti |    |
(6 rows)
</code></pre></div></div>

<p>LEFT [OUTER] JOINâ€™s results are those tuples in table A <strong>OR</strong> (A <strong>AND</strong> B).</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># SELECT * FROM TableA
LEFT OUTER JOIN TableB
ON TableA.name = TableB.name;

 id |   name    | id |  name
----+-----------+----+--------
  1 | Pirate    |  2 | Pirate
  3 | Ninja     |  4 | Ninja
  2 | Monkey    |    |
  4 | Spaghetti |    |
(4 rows)
</code></pre></div></div>

<h3 id="join-is-not-simple-in-greenplum">JOIN is not simple in Greenplum</h3>

<p>Greenplum is (was ?) a shared-nothing distributed data warehouse, data transferring (motion) between nodes costs a lot.</p>

<p>To have a better performance, Greenplum needs to avoid motions and loops as possible.</p>

<h2 id="how-does-greenplum-choose-the-path">How does Greenplum choose the path</h2>

<h3 id="build_simple_rel"><strong>build_simple_rel()</strong></h3>

<p>This stage is to get the info how data are distributed, GpPolicy.</p>

<p>The data to store are partitioned onto segment databases, the other data, for internal use like catalog, are not partitioned.</p>

<p>Entry database, I take it as the main backend, which <strong>holds</strong> none or all, but not a part of the data when processing.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/*
 * GpPolicyType represents a type of policy under which a relation's
 * tuples may be assigned to a component database.
 */
typedef enum GpPolicyType
{
    POLICYTYPE_PARTITIONED,     /* Tuples partitioned onto segment database. */
    POLICYTYPE_ENTRY            /* Tuples stored on entry database. */
} GpPolicyType;
</code></pre></div></div>

<h3 id="set_base_rel_pathlists"><strong>set_base_rel_pathlists()</strong></h3>

<p>Finds <strong>all</strong> paths available for scanning each base-relation entry, sequential scan and any available indices are considered.</p>

<p>RTE_FUNCTION: create_functionscan_path()<br />
RTE_RELATION: create_external_path() / create_aocs_path() / create_seqscan_path() / create_index_paths() â€¦<br />
RTE_VALUES: create_valuesscan_path()</p>

<h3 id="create_xxx_path"><strong>create_xxx_path()</strong></h3>

<p>Decide Locus (location, describing the distribution of a base relation).</p>

<p>The difference between entry policy and entry locus is that, entry database is a concept of how data store, entry locus is where data come from.</p>

<p>For instances, catalogâ€™s locus is <code class="language-plaintext highlighter-rouge">General</code> and its policy is <code class="language-plaintext highlighter-rouge">Entry</code>; The value to insert, its locus is <code class="language-plaintext highlighter-rouge">Entry</code>, data go into master firstly; <code class="language-plaintext highlighter-rouge">generate_series()</code>â€™s locus is <code class="language-plaintext highlighter-rouge">SingleQE</code>, it could be planned onto any db.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>typedef enum CdbLocusType
{
    CdbLocusType_Null,
    CdbLocusType_Entry,         /* a single backend process on the entry db:
                                 * usually the qDisp itself, but could be a
                                 * qExec started by the entry postmaster.
                                 */
    CdbLocusType_SingleQE,      /* a single backend process on any db: the
                                 * qDisp itself, or a qExec started by a
                                 * segment postmaster or the entry postmaster.
                                 */
    CdbLocusType_General,       /* compatible with any locus (data is
                                 * self-contained in the query plan or
                                 * generally available in any qExec or qDisp) */
    CdbLocusType_Replicated,    /* replicated over all qExecs of an N-gang */
    CdbLocusType_Hashed,        /* hash partitioned over all qExecs of N-gang */
    CdbLocusType_HashedOJ,      /* result of hash partitioned outer join */
    CdbLocusType_Strewn,        /* partitioned on no known function */
    CdbLocusType_End            /* = last valid CdbLocusType + 1 */
} CdbLocusType;
</code></pre></div></div>

<h3 id="make_rel_from_joinlist"><strong>make_rel_from_joinlist()</strong></h3>

<p>Build access paths using a â€œjoinlistâ€ to guide the join path search, nestloop, merge, hash?</p>

<h3 id="standard_join_search---set_cheapest"><strong>standard_join_search() -&gt; set_cheapest()</strong></h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for_each_cell(p, lnext(list_head(parent_rel-&gt;pathlist)))
{
	Path       *path = (Path *) lfirst(p);
	compare_path_costs(..., path, ...)
	if (BETTER)
		cheapest_total_path = path;
}
</code></pre></div></div>

<h2 id="quizzes">Quizzes</h2>

<p>What and where are the motions? <code class="language-plaintext highlighter-rouge">Entry</code>, <code class="language-plaintext highlighter-rouge">SingleQE</code>, <code class="language-plaintext highlighter-rouge">General</code>, <code class="language-plaintext highlighter-rouge">Hashed</code> and <code class="language-plaintext highlighter-rouge">Strewn</code> locuses, <strong>join</strong> and <strong>left join</strong>, each other?</p>

    </div>

    <br />
  
    <p class="date">
      <span>Aug 15, 2017</span>
    </p>

    <h1><a href="/blog/2017/08/fix-out-of-pty-devices/">Fix "out of pty devices" in Guardian containers</a></h1>

    <div class="content">
      <h2 id="who-are-affected">Who are affected</h2>

<p>Some certain Linux distros as Guardian containers, like SLES jobs on Concourse.</p>

<h2 id="how-to-reproduce">How to reproduce</h2>

<p>Create a SLES 11 SP4 Guardian container, then</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># useradd john
# su - john
$ python -c "import pty; pty.fork()"
...
OSError: out of pty devices
</code></pre></div></div>

<h2 id="why-is-this">Why is this</h2>

<blockquote>
  <p>A pseudo TTY (or â€œPTYâ€) is a pair of devices â€” a slave and a master â€” that provide a special sort of communication channel.</p>
</blockquote>

<blockquote>
  <p>Linux has a virtual filesystem called <code class="language-plaintext highlighter-rouge">devpts</code> that is normally mounted at <code class="language-plaintext highlighter-rouge">/dev/pts</code>. Whenever a new pseudo TTY is created, a device node for the slave is created in that virtual filesystem.</p>
</blockquote>

<blockquote>
  <p>â€œUnix98â€ Single Unix Specification (SUS) requires that the group ID of the slave device should not be that of the creating process, but rather some definite, though unspecified, value. The GNU C Library (glibc) takes responsibility for implementing this requirement; it quite reasonably chooses the ID of the group named â€œttyâ€ (often 5) to fill this role. If the devpts filesystem is mounted with options gid=5,mode=620, this group ID and the required access mode will be used and glibc will be happy. If not, glibc will (if so configured) run a setuid helper found at /usr/libexec/pt_chown.</p>
</blockquote>

<p>The problem is some Linux distros donâ€™t provide the setuid helper <code class="language-plaintext highlighter-rouge">pt_chown</code>, if <code class="language-plaintext highlighter-rouge">devpts</code> is not mounted with option <code class="language-plaintext highlighter-rouge">gid=5</code>, the device node could not be created with <code class="language-plaintext highlighter-rouge">tty</code> group.</p>

<h2 id="fix-and-workaround">Fix and workaround</h2>

<p>Guardianâ€™s default mount options are fixed now, workaround is adding normal users into <code class="language-plaintext highlighter-rouge">tty</code> group.</p>

<h3 id="ref">ref:</h3>
<p>1, <a href="https://lwn.net/Articles/688809/">https://lwn.net/Articles/688809/</a><br />
2, <a href="https://en.wikipedia.org/wiki/Single_UNIX_Specification">https://en.wikipedia.org/wiki/Single_UNIX_Specification</a></p>

    </div>

    <br />
  
    <p class="date">
      <span>May 26, 2017</span>
    </p>

    <h1><a href="/blog/2017/05/understanding-_GLIBCXX_USE_CXX11_ABI/">Understanding _GLIBCXX_USE_CXX11_ABI</a></h1>

    <div class="content">
      <p>C++ç¨‹åºå‘å¸ƒæ—¶éœ€è¦è‡ªå¸¦è¿è¡Œæ—¶ä¹ˆ? æˆ‘è§‰å¾—å¾ˆæœ‰å¿…è¦. å› ä¸ºå³ä½¿C++æ ‡å‡†ç›¸åŒ, ABIä¹Ÿä¸ä¸€å®š.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;iostream&gt;

int main()
{
    std::string str = "Hello, world!\n";
    std::cout &lt;&lt; str;

    return 0;
}
</code></pre></div></div>

<p>è¿™æ ·ä¸€ä¸ªç®€å•çš„C++ç¨‹åº, ç”¨g++ 6.2.0å’ŒC++98æ ‡å‡†ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶æ”¾åˆ°CentOS 5ä¸Šè¿è¡Œä¼šæç¤º:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./a.out: /usr/lib64/libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by ./a.out)
</code></pre></div></div>

<p>åˆæ²¡æœ‰ç”¨ä»€ä¹ˆå¾ˆæ–°çš„ç‰¹æ€§, è¿˜æŒ‡å®šäº†C++98æ ‡å‡†, CentOSä¸Šçš„g++ 4.1.2å½“ç„¶ä¹Ÿæ”¯æŒC++98, ä¸ºä»€ä¹ˆè¿˜ä¼šæŠ¥é”™?</p>

<p>å› ä¸ºä»GCC 5.1å¼€å§‹[1], <code class="language-plaintext highlighter-rouge">std::string</code>å’Œ<code class="language-plaintext highlighter-rouge">std::list</code>ä½¿ç”¨äº†æ–°çš„C++11çš„ABI, <strong>å³ä½¿ä½ æ˜¾å¼æŒ‡å®šä½¿ç”¨è€æ ‡å‡†</strong>.</p>

<p>è§£å†³æ–¹æ³•ä¸éš¾, æ‰‹åŠ¨å°†_GLIBCXX_USE_CXX11_ABIå®ç½®0å°±å¯ä»¥äº†, å½“ç„¶, ä¸ºäº†é¿å…æ›´å¤šçš„éº»çƒ¦(è°çŸ¥é“å“ªå„¿è¿˜æœ‰å‘å‘¢?), ä½ ä¹Ÿå¯ä»¥è‡ªå¸¦è¿è¡Œæ—¶å‘å¸ƒ, æ„Ÿè°¢GCC Runtime Library Exception[2], å³ä½¿ç§æœ‰è½¯ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„.</p>

<p>ä¸ºä»€ä¹ˆGCCè¦è¿™ä¹ˆåšå‘¢? æˆ‘æ˜¯ä¸å¤§ç†è§£, å®˜æ–¹æ–‡æ¡£è¯´å› ä¸ºè¿™æ ·å°±ä¿è¯å¯ä»¥å’ŒC++11çš„ä»£ç é“¾æ¥äº†, <strong>å³ä½¿ä½ æ˜¾å¼æŒ‡å®šä½¿ç”¨è€æ ‡å‡†</strong>, æƒŠä¸æƒŠå–œ?</p>

<h3 id="ref">ref:</h3>
<p>1, <a href="https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html">https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html</a><br />
2, <a href="https://www.gnu.org/licenses/gcc-exception-3.1.en.html">https://www.gnu.org/licenses/gcc-exception-3.1.en.html</a></p>

    </div>

    <br />
  
    <p class="date">
      <span>Apr 30, 2016</span>
    </p>

    <h1><a href="/blog/2016/04/autodependencies-with-make/">è‡ªåŠ¨å¤„ç†Makeçš„ä¾èµ–å…³ç³»</a></h1>

    <div class="content">
      <h2 id="makeæ˜¯å¦‚ä½•å·¥ä½œçš„">Makeæ˜¯å¦‚ä½•å·¥ä½œçš„</h2>

<p>ç®€å•è¯´, Makefileä¸­æŒ‡å®šç›®æ ‡å’Œä¾èµ–, ç„¶åMakeè¿è¡Œçš„æ—¶å€™ä¼šæ£€æµ‹æ–‡ä»¶çš„æ—¶é—´ä¿¡æ¯, å¦‚æœç›®æ ‡è½åäºä¾èµ–çš„ä¿®æ”¹æ—¶é—´åˆ™ç›®æ ‡éœ€è¦é‡æ–°ç”Ÿæˆ, ä»¥æ­¤è¾¾åˆ°æŒ‰éœ€ç”Ÿæˆ, èŠ‚çœæ—¶é—´çš„ç›®çš„.</p>

<h2 id="å®é™…åœºæ™¯ä¸­çš„é—®é¢˜æ˜¯ä»€ä¹ˆ">å®é™…åœºæ™¯ä¸­çš„é—®é¢˜æ˜¯ä»€ä¹ˆ</h2>

<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>OBJS := foo.o bar.o

program: $(OBJS)
	gcc $(OBJS) -o program

%.o: %.c
	gcc -c $(CFLAGS) $&lt; -o $@
</code></pre></div></div>

<p>è¿™ä¸ªMakefileè¡¨è¾¾çš„æ„æ€æ˜¯ç”±<code class="language-plaintext highlighter-rouge">foo.c</code>å’Œ<code class="language-plaintext highlighter-rouge">bar.c</code>ç”Ÿæˆ<code class="language-plaintext highlighter-rouge">program</code>, ä¸­é—´ç›®æ ‡æ–‡ä»¶åˆ†åˆ«ä¾èµ–ç›¸åº”çš„æºæ–‡ä»¶. ä½†æ˜¯å®é™…åœºæ™¯è¿œæ²¡æœ‰è¿™ä¹ˆç®€å•, ä¾‹å¦‚æ¯ä¸ª<code class="language-plaintext highlighter-rouge">.o</code>è¿˜ä¼šå„è‡ªä¾èµ–å¾ˆå¤šä¸åŒçš„<code class="language-plaintext highlighter-rouge">.h</code>å¤´æ–‡ä»¶, æ€ä¹ˆåŠ? æŒ¨ä¸ªåˆ—å‡ºæ¥ä¹ˆ? å¤ªéº»çƒ¦äº†, è€Œä¸”ä¾èµ–å…³ç³»è¿˜å¯èƒ½ä¼šå˜åŒ–.</p>

<h2 id="ä¾èµ–å…³ç³»èƒ½è‡ªåŠ¨ç”Ÿæˆä¹ˆ">ä¾èµ–å…³ç³»èƒ½è‡ªåŠ¨ç”Ÿæˆä¹ˆ</h2>

<p>å½“ç„¶å¯ä»¥, ç›´æ¥çœ‹ä»£ç :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>OBJS := foo.o bar.o

program: $(OBJS)
	gcc $(OBJS) -o program

-include $(OBJS:.o=.d)

%.o: %.c
	gcc -MD -MP -c $(CFLAGS) $&lt; -o $@
</code></pre></div></div>

<p>ç›¸è¾ƒäºä¹‹å‰çš„ç‰ˆæœ¬, è¿™æ¬¡æ¯ä¸ª<code class="language-plaintext highlighter-rouge">.o</code>çš„ç¼–è¯‘è¿‡ç¨‹ä¸­éƒ½ä¼šç”Ÿæˆä¸€ä¸ªMakefileè¯­æ³•çš„<code class="language-plaintext highlighter-rouge">.d</code>æ–‡ä»¶, é‡Œé¢åˆ—å‡ºäº†gccåˆ†æå¾—å‡ºçš„ä¾èµ–å…³ç³». æ‰€ä»¥å½“æˆ‘ä»¬æŠŠè¿™äº›<code class="language-plaintext highlighter-rouge">.d</code>æ–‡ä»¶åŒ…å«è¿›æ¥ä¹‹å, Makeå°±å¯ä»¥çŸ¥é“è¯¦ç»†çš„ä¾èµ–å…³ç³»ä¿¡æ¯, è¿›è€Œåˆ¤æ–­å“ªäº›ä¾èµ–å‘ç”Ÿäº†å˜åŒ–, å“ªäº›ç›®æ ‡éœ€è¦é‡æ–°ç”Ÿæˆ.</p>

<p>PS, å¦‚æœä½ ä¸æƒ³æŠŠç³»ç»Ÿå¤´æ–‡ä»¶ä¹Ÿåˆ—åœ¨ä¾èµ–é‡Œé¢, å¯ä»¥æŠŠå‚æ•°<code class="language-plaintext highlighter-rouge">-MD</code>æ¢æˆ<code class="language-plaintext highlighter-rouge">-MMD</code>.</p>

    </div>

    <br />
  
    <p class="date">
      <span>Mar 14, 2016</span>
    </p>

    <h1><a href="/blog/2016/03/linux-profiler-perf/">Linuxä¸‹çš„æ€§èƒ½åˆ†æå·¥å…·: Perf</a></h1>

    <div class="content">
      <h2 id="ä»€ä¹ˆæ˜¯perf">ä»€ä¹ˆæ˜¯Perf</h2>

<p>Perfæ˜¯ä¸€ä¸ªä¸Linux Kernelç´§å¯†ç»“åˆçš„è½¯ä»¶æ€§èƒ½åˆ†æå·¥å…·.</p>

<h2 id="perfçš„å·¥ä½œåŸç†">Perfçš„å·¥ä½œåŸç†</h2>

<p>Perfçš„åŸºæœ¬åŸç†æ˜¯hookäº‹ä»¶, å¯¹è¢«åˆ†æå¯¹è±¡è¿›è¡Œé‡‡æ ·, è·å–æ•°æ®å¹¶åˆ†æ. ä¾‹å¦‚åœ¨æ—¶é’Ÿä¸­æ–­è§¦å‘æ—¶é‡‡æ ·contextå¯ä»¥åˆ†æå‡½æ•°çš„è¿è¡Œæ—¶é—´, åœ¨cache missè§¦å‘æ—¶é‡‡æ ·å¯ä»¥åˆ†æç¼“å­˜çš„å·¥ä½œæ•ˆç‡. æ­¤å¤–, Perfè¿˜æ”¯æŒç¼ºé¡µ, è¿›ç¨‹åˆ‡æ¢, å…·ä½“å†…æ ¸å‡½æ•°ç­‰äº‹ä»¶, å…·ä½“å¯ä»¥å‚è€ƒ<code class="language-plaintext highlighter-rouge">perf list</code>.</p>

<h2 id="perfæ€ä¹ˆç”¨">Perfæ€ä¹ˆç”¨</h2>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">perf stat ./a.out</code>, <code class="language-plaintext highlighter-rouge">perf stat -p 1234</code>, åˆ†æç¨‹åºçš„æ•´ä½“æ€§èƒ½, å¯ä»¥çœ‹åˆ°ç¨‹åºçš„CPUä½¿ç”¨ç‡, è¿›ç¨‹åˆ‡æ¢æ¬¡æ•°, cacheåˆ©ç”¨æƒ…å†µç­‰ç­‰.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">perf top</code>, ç±»ä¼¼topå‘½ä»¤, å¯ä»¥åˆ†ææ•´ä¸ªç³»ç»Ÿå½“å‰çš„çŠ¶æ€, ä¾‹å¦‚å¯»æ‰¾å½“å‰ç³»ç»Ÿæœ€è€—æ—¶çš„ç”¨æˆ·è¿›ç¨‹æˆ–è€…å†…æ ¸å‡½æ•°.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">perf record</code>å’Œ<code class="language-plaintext highlighter-rouge">perf report</code>, å¯ä»¥è®°å½•å¹¶åˆ†æä¸€æ®µæ—¶é—´å†…çš„æ€§èƒ½äº‹ä»¶.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">perf --help</code> :)</p>
  </li>
</ul>

<h2 id="happy-Ï€-day">Happy Ï€ day!</h2>

<p>è¿™åªæ˜¯ç¯‡ç®€ä»‹, ä¸»æ—¨æ˜¯è¦è¯´æ˜Perfå¾ˆå¼ºå¤§å¾ˆæ˜“ç”¨<del>ä»¥åŠæ›´æ–°ä¸€ä¸‹blog</del>. å¦å¤–, åœ†å‘¨ç‡æ—¥å¿«ä¹!</p>

<h2 id="ref">ref:</h2>

<p>1, <a href="https://perf.wiki.kernel.org/">https://perf.wiki.kernel.org/</a><br />
2, <a href="http://www.brendangregg.com/perf.html">http://www.brendangregg.com/perf.html</a></p>

    </div>

    <br />
  
    <p class="date">
      <span>Aug 31, 2015</span>
    </p>

    <h1><a href="/blog/2015/08/why-does-tortoise-and-hare-algorithm-work/">é¾Ÿå…”ç®—æ³•ä¸ºä»€ä¹ˆæœ‰æ•ˆ</a></h1>

    <div class="content">
      <h2 id="ä»€ä¹ˆæ˜¯é¾Ÿå…”ç®—æ³•">ä»€ä¹ˆæ˜¯é¾Ÿå…”ç®—æ³•</h2>

<p>æ£€æµ‹å•é“¾è¡¨ä¸Šçš„ç¯æœ‰ä¸ªå¾ˆç»å…¸çš„ç®—æ³•å«åšâ€å¼—æ´›ä¼Šå¾·åˆ¤åœˆç®—æ³•â€, ä¹Ÿå«â€é¾Ÿå…”ç®—æ³•â€.</p>

<h2 id="é¾Ÿå…”ç®—æ³•çš„åŸºæœ¬æ€è·¯">é¾Ÿå…”ç®—æ³•çš„åŸºæœ¬æ€è·¯</h2>

<h3 id="æ˜¯å¦æœ‰ç¯">æ˜¯å¦æœ‰ç¯</h3>

<p>æˆ‘ä»¬è®©é¾Ÿ(tortoise)å’Œå…”(hare)ä»å•é“¾è¡¨çš„èµ·ç‚¹å‡ºå‘, æ¯æ¬¡é¾Ÿèµ°ä¸€æ­¥, å…”èµ°ä¸¤æ­¥, å¦‚æœtime_aæ­¥ä¹‹åé¾Ÿå…”ç›¸é‡, åˆ™è¯¥é“¾è¡¨æœ‰ç¯.</p>

<h3 id="ç¯çš„é•¿åº¦">ç¯çš„é•¿åº¦</h3>

<p>ä¸Šè¿°ç®—æ³•åˆšåˆ¤æ–­å‡ºå­˜åœ¨ç¯æ—¶, é¾Ÿå’Œå…”ä½äºåŒä¸€èŠ‚ç‚¹. æ­¤æ—¶è®©å…”ä¸åŠ¨, è€Œé¾Ÿä¸æ–­å‰è¿›, è‚¯å®šåˆä¼šç›¸é‡, è€Œè¿™ä¸€æ¬¡é¾Ÿå‰è¿›çš„æ­¥æ•°æ˜¾ç„¶å°±æ˜¯ç¯çš„é•¿åº¦length.</p>

<h3 id="ç¯çš„èµ·ç‚¹">ç¯çš„èµ·ç‚¹</h3>

<p>è¿˜æ˜¯ä¹‹å‰æ‰€è¯´é¾Ÿå…”ç›¸é‡çš„èŠ‚ç‚¹, é¦–å…ˆå…”ä¿æŒåŸä½, è€ŒæŠŠé¾Ÿç½®å›é“¾è¡¨èµ·ç‚¹, ç„¶åé¾Ÿå’Œå…”åŒæ—¶èµ°, æ¯æ¬¡éƒ½èµ°ä¸€æ­¥, ç»è¿‡time_bæ­¥æœ€ç»ˆå†æ¬¡ç›¸é‡, åˆ™è¿™æ¬¡ç›¸é‡çš„èŠ‚ç‚¹å°±æ˜¯ç¯çš„èµ·ç‚¹start.</p>

<h2 id="é¾Ÿå…”ç®—æ³•ä¸ºä»€ä¹ˆæœ‰æ•ˆ">é¾Ÿå…”ç®—æ³•ä¸ºä»€ä¹ˆæœ‰æ•ˆ</h2>

<p>å‡è®¾å…”æ¯æ¬¡èµ°stepæ­¥, é‚£ä¹ˆåªè¦å•é“¾è¡¨ä¸­å­˜åœ¨ç¯, è€Œä¸”é¾Ÿåˆ°è¾¾ç¯çš„èµ·ç‚¹ä¹‹å, é¾Ÿå’Œå…”ä¹‹é—´çš„è·¯ç¨‹å·®èƒ½å¤Ÿæ˜¯ç¯é•¿åº¦lengthçš„æ•´æ•°å€, åˆ™äºŒè€…å°±èƒ½ç›¸é‡. å³:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>((step - 1) * time_a) % length == 0  &amp;&amp; time_a &gt;= start
</code></pre></div></div>

<p>å…¶ä¸­startå’Œlengthæ˜¯å›ºå®šçš„, time_aå´æ— é™å¢é•¿, æ‰€ä»¥æ€»ä¼šæœ‰æœºä¼šæ•´é™¤, æ‰€ä»¥é¾Ÿå…”ç®—æ³•å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰ç¯.</p>

<p>ç•¥è¿‡æ˜¾è€Œæ˜“è§çš„é•¿åº¦è®¡ç®—, æ¥ç€è¯´æŸ¥æ‰¾ç¯çš„èµ·ç‚¹. å½“ä»…å½“stepä¸º2, å³å…”æ¯æ¬¡èµ°ä¸¤æ­¥æ—¶, æ ¹æ®å‰é¢çš„æ¡ä»¶å¾—çŸ¥time_aèƒ½è¢«lengthæ•´é™¤. äºæ˜¯æˆ‘ä»¬æ¥ç€å‡è®¾time_bä¸ºé¾Ÿåˆ°è¾¾ç¯çš„èµ·ç‚¹startåç»•äº†nåœˆå†æ¬¡åˆ°è¾¾èµ·ç‚¹, å³<code class="language-plaintext highlighter-rouge">time_b == start + n * length</code>, åˆ™å…”æ­¤æ—¶çš„ä½ç½®(å‡è®¾ç»•äº†måœˆ)æ˜¯<code class="language-plaintext highlighter-rouge">time_a + time_b - m * length</code>, ä»£å…¥åä¸º<code class="language-plaintext highlighter-rouge">time_a + start + (n - m) * length</code>, å› ä¸ºstepä¸º2æ—¶time_aèƒ½è¢«lengthæ•´é™¤, æ‰€ä»¥å…”æ­¤æ—¶æ­£å¥½ä¹Ÿåœ¨èµ·ç‚¹startå¤„, æ‰€ä»¥é¾Ÿå…”ç®—æ³•å¯ä»¥æ‰¾åˆ°ç¯çš„èµ·ç‚¹.</p>

    </div>

    <br />
  
    <p class="date">
      <span>Apr 26, 2015</span>
    </p>

    <h1><a href="/blog/2015/04/hybrid-bootable-usb-stick-for-uefi-and-legacy-bios/">Hybrid bootable USB stick for legacy BIOS & UEFI</a></h1>

    <div class="content">
      <p>This is a simple note for people who are googling this topic right now, and you are welcome.</p>

<h2 id="backgrounds">Backgrounds</h2>

<ul>
  <li>
    <p>Legacy BIOS needs bootloaders to be installed into MBR and the reserved space after it.</p>
  </li>
  <li>
    <p>UEFI only needs bootloaders in ESP(EFI System Partition).</p>
  </li>
  <li>
    <p>There is no resource competition between legacy BIOS and UEFI requirements.</p>
  </li>
</ul>

<h2 id="preparations">Preparations</h2>

<ul>
  <li>
    <p>grub-pc-bin and grub-efi-amd64-bin packages for Debian users.</p>
  </li>
  <li>
    <p>An USB storage stick, MBR or GPT. Some unallocated space(1MB is enough) at the beginning of disk if you are using GPT.</p>
  </li>
  <li>
    <p>A vfat partition with the â€œbootâ€ flag.</p>
  </li>
</ul>

<h2 id="cooking">Cooking</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># mount /dev/sdb1 /media/sdb1

# grub-install --target=i386-pc --boot-directory=/media/sdb1/boot /dev/sdb

# grub-install --target=x86_64-efi --efi-directory=/media/sdb1/ --boot-directory=/media/sdb1/boot --removable /dev/sdb
</code></pre></div></div>

<h2 id="configurationjust-a-template">Configuration(just a template)</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /media/sdb1/boot/grub/grub.cfg
set root=(hd0,1)

menuentry "FreeDOS" {
        linux16  /boot/freedos/memdisk
        initrd16 /boot/freedos/balder10.img
}
menuentry "Memtest86+" {
        loopback loop /boot/systemrescuecd-x86-x.y.z.iso
        linux16 (loop)/bootdisk/memtestp
}
menuentry "Ubuntu xx.yy" {
        set isofile="/boot/ubuntu-xx.yy-desktop-amd64.iso"
        loopback loop $isofile
        linux (loop)/casper/vmlinuz.efi boot=casper iso-scan/filename=$isofile noprompt noeject
        initrd (loop)/casper/initrd.lz
}
menuentry "SystemRescueCd" {
        set isofile="/boot/systemrescuecd-x86-x.y.z.iso"
        loopback loop $isofile
        linux   (loop)/isolinux/rescue64 docache isoloop=$isofile
        initrd  (loop)/isolinux/initram.igz
}
menuentry "Install Debian GNU/Linux" {
        linux   /boot/debian/vmlinuz priority=low recommends=false
        initrd  /boot/debian/initrd.gz
}
menuentry "Debian GNU/Linux Rescue Mode" {
        linux   /boot/debian/vmlinuz priority=low recommends=false rescue/enable=true
        initrd  /boot/debian/initrd.gz
}
</code></pre></div></div>

<p>Done, enjoy fixing othersâ€™ computers then, which I already quit :D</p>

    </div>

    <br />
  
    <p class="date">
      <span>Nov 23, 2014</span>
    </p>

    <h1><a href="/blog/2014/11/use-gnu-global-for-source-code-tagging/">ä½¿ç”¨GNU GLOBALç´¢å¼•ä»£ç </a></h1>

    <div class="content">
      <h2 id="ä»€ä¹ˆæ˜¯global">ä»€ä¹ˆæ˜¯GLOBAL</h2>

<p><a href="https://www.gnu.org/software/global/">GLOBAL</a>æ˜¯GNUå‡ºå“çš„ä¸€æ¬¾ä»£ç ç´¢å¼•å·¥å…·.</p>

<h2 id="globalæœ‰ä»€ä¹ˆä¼˜ç‚¹">GLOBALæœ‰ä»€ä¹ˆä¼˜ç‚¹</h2>

<ul>
  <li>
    <p>åŸç”Ÿæ”¯æŒC, C++, æ±‡ç¼–ç­‰6ç§è¯­è¨€çš„ä»£ç ç´¢å¼•, å€ŸåŠ©æ’ä»¶æ”¯æŒçš„æ›´å¤šè¾¾25ç§</p>
  </li>
  <li>
    <p>æ”¯æŒå¤šç§æŸ¥æ‰¾åŠŸèƒ½, ä¾‹å¦‚æœ€å¸¸ç”¨çš„æŸ¥æ‰¾å®šä¹‰, è°ƒç”¨å’Œæ–‡ä»¶ä½ç½®ç­‰</p>
  </li>
  <li>
    <p>æä¾›gtags-cscopeå‘½ä»¤, å…¼å®¹cscope</p>
  </li>
  <li>
    <p>ç›¸å¯¹äºcscope, æŸ¥æ‰¾åŒ¹é…æ›´åŠ å¿«é€Ÿå’Œå‡†ç¡®</p>
  </li>
  <li>
    <p>æ”¯æŒå¢é‡æ›´æ–°, è€Œä¸”æ¯”cscopeçš„å¢é‡æ›´æ–°å¿«å¾ˆå¤šå¾ˆå¤š</p>
  </li>
  <li>
    <p>å¼€å‘æ´»è·ƒ, ä¸Šä¸€æ¬¡å‘å¸ƒæ–°ç‰ˆæœ¬æ˜¯ä¸¤ä¸ªæœˆå‰, è€Œcscopeçš„ä¸Šä¸€æ¬¡æ˜¯ä¸¤å¹´å‰</p>
  </li>
</ul>

<h2 id="å¦‚ä½•ä½¿ç”¨global">å¦‚ä½•ä½¿ç”¨GLOBAL</h2>

<p>ç®€å•è®², åœ¨ä»£ç ç›®å½•ä¸­æ‰§è¡Œ<code class="language-plaintext highlighter-rouge">gtags -i</code>å»ºç«‹ç´¢å¼•æ•°æ®åº“, ç„¶åä½¿ç”¨globalå‘½ä»¤æŸ¥æ‰¾åŒ¹é…. ä¾‹å¦‚<code class="language-plaintext highlighter-rouge">global symbol</code>æŸ¥çœ‹symbolçš„å®šä¹‰, <code class="language-plaintext highlighter-rouge">global -r symbol</code>æŸ¥çœ‹symbolåœ¨å“ªè¢«å¼•ç”¨, ç­‰ç­‰. è¯¦è§: <a href="https://www.gnu.org/software/global/globaldoc_toc.html">https://www.gnu.org/software/global/globaldoc_toc.html</a></p>

<h2 id="vimä¸­ä½¿ç”¨globalçš„å°æŠ€å·§">Vimä¸­ä½¿ç”¨GLOBALçš„å°æŠ€å·§</h2>

<p>ç»§æ‰¿Vimä¸­cscopeçš„æ¥å£å’Œé”®ç»‘å®š:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>:set cscopeprg=gtags-cscope
</code></pre></div></div>

<p>è‡ªåŠ¨ä»å½“å‰æ–‡ä»¶å¤¹é€’å½’å‘ä¸Šæœç´¢ç´¢å¼•æ•°æ®åº“å¹¶åŠ è½½:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function! LoadDatabase()
	let db = findfile("GTAGS", ".;")
	if (!empty(db))
		set nocscopeverbose
		exe "cs add " . db
		set cscopeverbose
	endif
endfunction
autocmd BufEnter *.[ch] call LoadDatabase()
</code></pre></div></div>

    </div>

    <br />
  

</div>


<div style="text-align:center" class="pagination">
  
    <span>&laquo; Prev</span>
  

  
    
      <em>1</em>
    
  
    
      <a href="/blog/page2/">2</a>
    
  
    
      <a href="/blog/page3/">3</a>
    
  
    
      <a href="/blog/page4/">4</a>
    
  
    
      <a href="/blog/page5/">5</a>
    
  
    
      <a href="/blog/page6/">6</a>
    
  
    
      <a href="/blog/page7/">7</a>
    
  
    
      <a href="/blog/page8/">8</a>
    
  
    
      <a href="/blog/page9/">9</a>
    
  

  
    <a href="/blog/page2/">Next &raquo;</a>
  
</div>


      </div>
    </main><footer class="site-footer h-card">

  <div style="text-align:center" class="license">
    Copyright Â© 2010-2024 Adam Lee, licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/">CC BY-NC-SA 3.0</a>
  </div>

</footer>
</body>

</html>
