<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Adam&apos;s</title>
    <description>Adam&apos;s blog</description>
    <link>http://adam8157.info/</link>
    <atom:link href="http://adam8157.info/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Tue, 09 Jan 2024 16:02:32 +0800</pubDate>
    <lastBuildDate>Tue, 09 Jan 2024 16:02:32 +0800</lastBuildDate>
    <generator>Jekyll v4.3.2</generator>
    
      <item>
        <title>Why does offlineimap not work with launchd</title>
        <description>&lt;p&gt;&lt;strong&gt;TL;DR, donâ€™t place your Maildir into Documents, Downloads or Desktop.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Iâ€™m a heavy user of offlineimap. Thanks to Homebrew, which provides a quite nice plist (which stands for â€œproperty listâ€) file for macOSâ€™s launchd to start the service at login, the offlineimap always works well until macOS &lt;del&gt;Vista&lt;/del&gt; Catalina.&lt;/p&gt;

&lt;p&gt;Days ago, after I upgraded the system to Catalina, offlineimap stopped working, no new mails got in at all. Although I appreciate the break, itâ€™s a thing need to be fixed.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;offlineimap -o&lt;/code&gt; directly, good, so itâ€™s a launchd thing.&lt;/li&gt;
  &lt;li&gt;Enable the launchd logging, it reports â€œOperation not permittedâ€ when &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;os.listdir()&lt;/code&gt;, what?&lt;/li&gt;
  &lt;li&gt;Check the UID, it has the permission.&lt;/li&gt;
  &lt;li&gt;Check the effective UID, itâ€™s the same as the UID.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;After almost two hoursâ€™ searching, I got nothing interesting and went back to think â€œWhy does it not work after upgrading to Catalina?â€&lt;/p&gt;

&lt;p&gt;The answer is right in &lt;a href=&quot;https://developer.apple.com/documentation/macos_release_notes/macos_catalina_10_15_release_notes&quot;&gt;macOS Catalina Release Notes&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Launch daemons and launch agents introduce new user privacy protections. Specifying privacy-sensitive files and folders in a launchd property list might not work as expected and prevent the service from running.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ğŸ™„ Good work, Apple.&lt;/p&gt;
</description>
        <pubDate>Fri, 22 Nov 2019 21:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2019/11/why-does-offlineimap-not-work-with-launchd/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2019/11/why-does-offlineimap-not-work-with-launchd/</guid>
        
        
      </item>
    
      <item>
        <title>Jump consistent hashç®—æ³•åˆ†æ</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://arxiv.org/pdf/1406.2294.pdf&quot; title=&quot;è®ºæ–‡é“¾æ¥&quot;&gt;Jump Consistent Hash&lt;/a&gt;æ˜¯ä¸€ä¸ªæ¥è‡ªGoogleçš„å¿«é€Ÿ, å‡ ä¹æ²¡æœ‰å†…å­˜æ¶ˆè€—çš„ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•. è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘çš„ç¿»è¯‘å’Œç†è§£æ€è·¯.&lt;/p&gt;

&lt;h2 id=&quot;å“ˆå¸Œç®—æ³•çš„è®¾è®¡ç›®æ ‡&quot;&gt;å“ˆå¸Œç®—æ³•çš„è®¾è®¡ç›®æ ‡&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;å¹³è¡¡æ€§, æŠŠå¯¹è±¡å‡åŒ€åœ°åˆ†å¸ƒåœ¨æ‰€æœ‰æ¡¶(bucket)ä¸­.&lt;/li&gt;
  &lt;li&gt;å•è°ƒæ€§, å½“æ¡¶çš„æ•°é‡å˜åŒ–æ—¶, åªéœ€è¦æŠŠä¸€äº›å¯¹è±¡ä»æ—§æ¡¶ç§»åŠ¨åˆ°æ–°æ¡¶, ä¸éœ€è¦åšå…¶å®ƒ(ä¾‹å¦‚æ—§æ¡¶ä¹‹é—´çš„)ç§»åŠ¨.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨çš„ç³»ç»Ÿ, æŒ‰å“ˆå¸Œåˆ†å¸ƒå¸¦æ¥ä¼˜åŒ–çš„ä¾¿åˆ©, å¹³è¡¡æ€§å¯ä»¥é¿å…æ•°æ®å€¾æ–œ, å•è°ƒæ€§åˆ™ä½¿å¾—æ‰©å®¹å’Œå‡å®¹æ›´å¿«é€Ÿ.&lt;/p&gt;

&lt;h2 id=&quot;ç®—æ³•çš„è®¾è®¡æ€è·¯&quot;&gt;ç®—æ³•çš„è®¾è®¡æ€è·¯&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ç”¨å¾ªåºæ¸è¿›çš„æ€è·¯æ¥è®¾è®¡, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ch(key, num_buckets)&lt;/code&gt;ä¸ºæ¡¶æ•°ä¸ºnum_bucketsæ—¶çš„hashå‡½æ•°, ä¸ºäº†æ»¡è¶³è®¾è®¡ç›®æ ‡, éœ€è¦:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;num_bucketsä¸º1æ—¶, ä»»æ„key, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ch(key, 1)==0&lt;/code&gt;, å…¨è½åœ¨ç¬¬0ä¸ªæ¡¶é‡Œ.&lt;/li&gt;
  &lt;li&gt;num_bucketsç”±1&lt;strong&gt;å˜ä¸º&lt;/strong&gt;2å, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ch(key, 2)&lt;/code&gt;åº”è¯¥æœ‰1/2çš„ç»“æœä¿æŒä¸º0, æœ‰1/2å˜ä¸º1.&lt;/li&gt;
  &lt;li&gt;â€¦&lt;/li&gt;
  &lt;li&gt;num_bucketsç”±n&lt;strong&gt;å˜ä¸º&lt;/strong&gt;n+1å, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ch(key, n+1)&lt;/code&gt;åº”è¯¥æœ‰n/(n+1)çš„ç»“æœä¿æŒä¸å˜, æœ‰1/(n+1)è·³å˜ä¸ºn+1.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å› æ­¤, åªè¦æˆ‘ä»¬ç”¨ä¸€ä¸ªåˆ†å¸ƒå‡åŒ€çš„å‡½æ•°, ä¾‹å¦‚ä¼ªéšæœºæ•°ç”Ÿæˆå™¨, å¹¶ä¸”è®©è¿™ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„çŠ¶æ€åªä¾èµ–äºkey, ä»0ä¸ªæ¡¶å¼€å§‹æ¨å¯¼, å˜åˆ°ç¬¬num_bucketsä¸ªæ¡¶, ç»“æœå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„hashå€¼:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;int ch(int key, int num_buckets) {
    random.seed(key);
    int b = 0;
    for (int j = 1; j &amp;lt; num_buckets; j++) {
        if (random.next() &amp;lt; 1.0 / (j + 1))
            b = j;
    }
    return b;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å¾ˆæ˜¾ç„¶, è¿™ä¸ªç®—æ³•æ˜¯O(n)çš„, è€Œä¸”éšç€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;j&lt;/code&gt;è¶Šæ¥è¶Šå¤§, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b=j&lt;/code&gt;éœ€è¦æ‰§è¡Œçš„æ¦‚ç‡ä¹Ÿè¶Šæ¥è¶Šä½. Googleæœ€ç»ˆçš„ç®—æ³•å«&lt;strong&gt;Jump&lt;/strong&gt; Consistent Hash, JumpæŒ‡çš„æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;j&lt;/code&gt;æ˜¯è·³è·ƒçš„, é‚£ä»–ä»¬æ˜¯æ€ä¹ˆè®©&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;j&lt;/code&gt;è·³è·ƒ, å¹¶ä¿æŒç»“æœæ­£ç¡®å‘¢?&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ç”¨æ¦‚ç‡çš„æ€è·¯æ¥æƒ³è¿™ä¸ªé—®é¢˜, å‡è®¾å˜åŒ–è¿‡ç¨‹ä¸­çš„ä¸Šä¸€æ¬¡ç»“æœæ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b&lt;/code&gt;, ä¸‹ä¸€æ¬¡ç»“æœ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;j&lt;/code&gt;å¤§äºç­‰äºä¸€ä¸ªå¤§äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b&lt;/code&gt;çš„æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;i&lt;/code&gt;çš„æ¦‚ç‡, ä¹Ÿå°±æ˜¯&lt;strong&gt;å¯ä»¥è·³åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;i&lt;/code&gt;çš„æ¦‚ç‡&lt;/strong&gt;, ä¹Ÿå°±æ˜¯ä»&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b+1&lt;/code&gt;åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;i&lt;/code&gt;çš„è¿‡ç¨‹ä¸­, æ¡¶åºå·éƒ½æ²¡æœ‰å˜çš„æ¦‚ç‡ä¸º:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;P(j&amp;gt;=i) = P(ch(key, b+1)==ch(key, i))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªæ¦‚ç‡ä¹Ÿå°±æ˜¯è¿ç»­å¤šæ¬¡ä¸å˜äº‹ä»¶æ¦‚ç‡çš„ä¹˜ç§¯:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;P(j&amp;gt;=i) = P(ch(key, b+1)==ch(k, b+2)) * P(ch(key, b+2)==ch(key, b+3)) * ... * P(ch(key, i-1)==ch(key, i))
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºå•æ¬¡ä¸å˜çš„æ¦‚ç‡ä¸º:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;P(ch(key, i)==ch(key, i+1)) = i/(i+1)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;æ‰€ä»¥è¿ç»­å¤šæ¬¡ä¸å˜çš„æ¦‚ç‡ä¸º:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;P(j&amp;gt;=i) = (b+1)/(b+2) * (b+2)/(b+3) * ... * (i-1)/i = (b+1)/i
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åŸºäºä¹‹å‰çš„ä»£ç , å½“éšæœºç»“æœ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r&lt;/code&gt;å°äº&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(b+1)/i&lt;/code&gt;æ—¶è·³åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;i&lt;/code&gt;å°±å¯ä»¥ä¿æŒæ¦‚ç‡ä¸å˜, ä¹Ÿå°±æ˜¯ä»»æ„çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r&lt;/code&gt;éƒ½å¯ä»¥è·³åˆ°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;floor((b+1)/r)&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;int ch(int key, int num_buckets) {
    random.seed(key);
    int b = -1;
    int j = 0;
    while (j &amp;lt; num_buckets) {
        b = j;
        double r = random.next();
        j = floor((b + 1) / r);
    }
    return b;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;æœ€ç»ˆçš„å®Œæ•´ä»£ç &quot;&gt;æœ€ç»ˆçš„å®Œæ•´ä»£ç &lt;/h2&gt;

&lt;p&gt;æœ€ç»ˆä»£ç é‡Œæ²¡æœ‰ç”¨randomå‡½æ•°, è€Œæ˜¯å†™äº†ä¸€ä¸ªåŸºäºâ€çº¿æ€§åŒä½™æ–¹æ³•â€çš„ä¼ªéšæœºæ•°äº§ç”Ÿå™¨, æ„æ€æ˜¯ä¸€æ ·çš„.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;int32_t JumpConsistentHash(uint64_t key, int32_t num_buckets) {
    int64_t b = -1, j = 0;
    while (j &amp;lt; num_buckets) {
        b = j;
        key = key * 2862933555777941757ULL + 1;
        j = (b + 1) * (double(1LL &amp;lt;&amp;lt; 31) / double((key &amp;gt;&amp;gt; 33) + 1));
    }
    return b;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 30 Jun 2018 16:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2018/06/jump-consistent-hash-explained/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2018/06/jump-consistent-hash-explained/</guid>
        
        
      </item>
    
      <item>
        <title>How Greenplum plans a JOIN</title>
        <description>&lt;h2 id=&quot;what-is-a-join&quot;&gt;What is a â€œJOINâ€&lt;/h2&gt;

&lt;p&gt;INNER JOIN is an &lt;strong&gt;AND&lt;/strong&gt;, OUTER JOIN is an &lt;strong&gt;OR&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;id name       id  name
-- ----       --  ----
1  Pirate     1   Rutabaga
2  Monkey     2   Pirate
3  Ninja      3   Darth Vader
4  Spaghetti  4   Ninja
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;INNER JOINâ€™s results are those tuples in table A &lt;strong&gt;AND&lt;/strong&gt; B.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# SELECT * FROM TableA
INNER JOIN TableB
ON TableA.name = TableB.name;

 id |  name  | id |  name
----+--------+----+--------
  3 | Ninja  |  4 | Ninja
  1 | Pirate |  2 | Pirate
(2 rows)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;FULL [OUTER] JOINâ€™s results are those tuples in table A &lt;strong&gt;OR&lt;/strong&gt; B.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# SELECT * FROM TableA
FULL OUTER JOIN TableB
ON TableA.name = TableB.name;
 id |   name    | id |    name
----+-----------+----+-------------
  3 | Ninja     |  4 | Ninja
    |           |  3 | Darth Vader
  2 | Monkey    |    |
  1 | Pirate    |  2 | Pirate
    |           |  1 | Rutabaga
  4 | Spaghetti |    |
(6 rows)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;LEFT [OUTER] JOINâ€™s results are those tuples in table A &lt;strong&gt;OR&lt;/strong&gt; (A &lt;strong&gt;AND&lt;/strong&gt; B).&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# SELECT * FROM TableA
LEFT OUTER JOIN TableB
ON TableA.name = TableB.name;

 id |   name    | id |  name
----+-----------+----+--------
  1 | Pirate    |  2 | Pirate
  3 | Ninja     |  4 | Ninja
  2 | Monkey    |    |
  4 | Spaghetti |    |
(4 rows)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;join-is-not-simple-in-greenplum&quot;&gt;JOIN is not simple in Greenplum&lt;/h3&gt;

&lt;p&gt;Greenplum is (was ?) a shared-nothing distributed data warehouse, data transferring (motion) between nodes costs a lot.&lt;/p&gt;

&lt;p&gt;To have a better performance, Greenplum needs to avoid motions and loops as possible.&lt;/p&gt;

&lt;h2 id=&quot;how-does-greenplum-choose-the-path&quot;&gt;How does Greenplum choose the path&lt;/h2&gt;

&lt;h3 id=&quot;build_simple_rel&quot;&gt;&lt;strong&gt;build_simple_rel()&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;This stage is to get the info how data are distributed, GpPolicy.&lt;/p&gt;

&lt;p&gt;The data to store are partitioned onto segment databases, the other data, for internal use like catalog, are not partitioned.&lt;/p&gt;

&lt;p&gt;Entry database, I take it as the main backend, which &lt;strong&gt;holds&lt;/strong&gt; none or all, but not a part of the data when processing.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/*
 * GpPolicyType represents a type of policy under which a relation&apos;s
 * tuples may be assigned to a component database.
 */
typedef enum GpPolicyType
{
    POLICYTYPE_PARTITIONED,     /* Tuples partitioned onto segment database. */
    POLICYTYPE_ENTRY            /* Tuples stored on entry database. */
} GpPolicyType;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;set_base_rel_pathlists&quot;&gt;&lt;strong&gt;set_base_rel_pathlists()&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Finds &lt;strong&gt;all&lt;/strong&gt; paths available for scanning each base-relation entry, sequential scan and any available indices are considered.&lt;/p&gt;

&lt;p&gt;RTE_FUNCTION: create_functionscan_path()&lt;br /&gt;
RTE_RELATION: create_external_path() / create_aocs_path() / create_seqscan_path() / create_index_paths() â€¦&lt;br /&gt;
RTE_VALUES: create_valuesscan_path()&lt;/p&gt;

&lt;h3 id=&quot;create_xxx_path&quot;&gt;&lt;strong&gt;create_xxx_path()&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Decide Locus (location, describing the distribution of a base relation).&lt;/p&gt;

&lt;p&gt;The difference between entry policy and entry locus is that, entry database is a concept of how data store, entry locus is where data come from.&lt;/p&gt;

&lt;p&gt;For instances, catalogâ€™s locus is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;General&lt;/code&gt; and its policy is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Entry&lt;/code&gt;; The value to insert, its locus is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Entry&lt;/code&gt;, data go into master firstly; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;generate_series()&lt;/code&gt;â€™s locus is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SingleQE&lt;/code&gt;, it could be planned onto any db.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;typedef enum CdbLocusType
{
    CdbLocusType_Null,
    CdbLocusType_Entry,         /* a single backend process on the entry db:
                                 * usually the qDisp itself, but could be a
                                 * qExec started by the entry postmaster.
                                 */
    CdbLocusType_SingleQE,      /* a single backend process on any db: the
                                 * qDisp itself, or a qExec started by a
                                 * segment postmaster or the entry postmaster.
                                 */
    CdbLocusType_General,       /* compatible with any locus (data is
                                 * self-contained in the query plan or
                                 * generally available in any qExec or qDisp) */
    CdbLocusType_Replicated,    /* replicated over all qExecs of an N-gang */
    CdbLocusType_Hashed,        /* hash partitioned over all qExecs of N-gang */
    CdbLocusType_HashedOJ,      /* result of hash partitioned outer join */
    CdbLocusType_Strewn,        /* partitioned on no known function */
    CdbLocusType_End            /* = last valid CdbLocusType + 1 */
} CdbLocusType;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;make_rel_from_joinlist&quot;&gt;&lt;strong&gt;make_rel_from_joinlist()&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Build access paths using a â€œjoinlistâ€ to guide the join path search, nestloop, merge, hash?&lt;/p&gt;

&lt;h3 id=&quot;standard_join_search---set_cheapest&quot;&gt;&lt;strong&gt;standard_join_search() -&amp;gt; set_cheapest()&lt;/strong&gt;&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;for_each_cell(p, lnext(list_head(parent_rel-&amp;gt;pathlist)))
{
	Path       *path = (Path *) lfirst(p);
	compare_path_costs(..., path, ...)
	if (BETTER)
		cheapest_total_path = path;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;quizzes&quot;&gt;Quizzes&lt;/h2&gt;

&lt;p&gt;What and where are the motions? &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Entry&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SingleQE&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;General&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Hashed&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Strewn&lt;/code&gt; locuses, &lt;strong&gt;join&lt;/strong&gt; and &lt;strong&gt;left join&lt;/strong&gt;, each other?&lt;/p&gt;
</description>
        <pubDate>Thu, 31 May 2018 16:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2018/05/how-greenplum-plans-a-join/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2018/05/how-greenplum-plans-a-join/</guid>
        
        
      </item>
    
      <item>
        <title>Fix &quot;out of pty devices&quot; in Guardian containers</title>
        <description>&lt;h2 id=&quot;who-are-affected&quot;&gt;Who are affected&lt;/h2&gt;

&lt;p&gt;Some certain Linux distros as Guardian containers, like SLES jobs on Concourse.&lt;/p&gt;

&lt;h2 id=&quot;how-to-reproduce&quot;&gt;How to reproduce&lt;/h2&gt;

&lt;p&gt;Create a SLES 11 SP4 Guardian container, then&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# useradd john
# su - john
$ python -c &quot;import pty; pty.fork()&quot;
...
OSError: out of pty devices
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;why-is-this&quot;&gt;Why is this&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;A pseudo TTY (or â€œPTYâ€) is a pair of devices â€” a slave and a master â€” that provide a special sort of communication channel.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;Linux has a virtual filesystem called &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;devpts&lt;/code&gt; that is normally mounted at &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/dev/pts&lt;/code&gt;. Whenever a new pseudo TTY is created, a device node for the slave is created in that virtual filesystem.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;â€œUnix98â€ Single Unix Specification (SUS) requires that the group ID of the slave device should not be that of the creating process, but rather some definite, though unspecified, value. The GNU C Library (glibc) takes responsibility for implementing this requirement; it quite reasonably chooses the ID of the group named â€œttyâ€ (often 5) to fill this role. If the devpts filesystem is mounted with options gid=5,mode=620, this group ID and the required access mode will be used and glibc will be happy. If not, glibc will (if so configured) run a setuid helper found at /usr/libexec/pt_chown.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The problem is some Linux distros donâ€™t provide the setuid helper &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pt_chown&lt;/code&gt;, if &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;devpts&lt;/code&gt; is not mounted with option &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gid=5&lt;/code&gt;, the device node could not be created with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tty&lt;/code&gt; group.&lt;/p&gt;

&lt;h2 id=&quot;fix-and-workaround&quot;&gt;Fix and workaround&lt;/h2&gt;

&lt;p&gt;Guardianâ€™s default mount options are fixed now, workaround is adding normal users into &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tty&lt;/code&gt; group.&lt;/p&gt;

&lt;h3 id=&quot;ref&quot;&gt;ref:&lt;/h3&gt;
&lt;p&gt;1, &lt;a href=&quot;https://lwn.net/Articles/688809/&quot;&gt;https://lwn.net/Articles/688809/&lt;/a&gt;&lt;br /&gt;
2, &lt;a href=&quot;https://en.wikipedia.org/wiki/Single_UNIX_Specification&quot;&gt;https://en.wikipedia.org/wiki/Single_UNIX_Specification&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Tue, 15 Aug 2017 16:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2017/08/fix-out-of-pty-devices/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2017/08/fix-out-of-pty-devices/</guid>
        
        
      </item>
    
      <item>
        <title>Understanding _GLIBCXX_USE_CXX11_ABI</title>
        <description>&lt;p&gt;C++ç¨‹åºå‘å¸ƒæ—¶éœ€è¦è‡ªå¸¦è¿è¡Œæ—¶ä¹ˆ? æˆ‘è§‰å¾—å¾ˆæœ‰å¿…è¦. å› ä¸ºå³ä½¿C++æ ‡å‡†ç›¸åŒ, ABIä¹Ÿä¸ä¸€å®š.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;

int main()
{
    std::string str = &quot;Hello, world!\n&quot;;
    std::cout &amp;lt;&amp;lt; str;

    return 0;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·ä¸€ä¸ªç®€å•çš„C++ç¨‹åº, ç”¨g++ 6.2.0å’ŒC++98æ ‡å‡†ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶æ”¾åˆ°CentOS 5ä¸Šè¿è¡Œä¼šæç¤º:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./a.out: /usr/lib64/libstdc++.so.6: version `GLIBCXX_3.4.21&apos; not found (required by ./a.out)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;åˆæ²¡æœ‰ç”¨ä»€ä¹ˆå¾ˆæ–°çš„ç‰¹æ€§, è¿˜æŒ‡å®šäº†C++98æ ‡å‡†, CentOSä¸Šçš„g++ 4.1.2å½“ç„¶ä¹Ÿæ”¯æŒC++98, ä¸ºä»€ä¹ˆè¿˜ä¼šæŠ¥é”™?&lt;/p&gt;

&lt;p&gt;å› ä¸ºä»GCC 5.1å¼€å§‹[1], &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;std::string&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;std::list&lt;/code&gt;ä½¿ç”¨äº†æ–°çš„C++11çš„ABI, &lt;strong&gt;å³ä½¿ä½ æ˜¾å¼æŒ‡å®šä½¿ç”¨è€æ ‡å‡†&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;è§£å†³æ–¹æ³•ä¸éš¾, æ‰‹åŠ¨å°†_GLIBCXX_USE_CXX11_ABIå®ç½®0å°±å¯ä»¥äº†, å½“ç„¶, ä¸ºäº†é¿å…æ›´å¤šçš„éº»çƒ¦(è°çŸ¥é“å“ªå„¿è¿˜æœ‰å‘å‘¢?), ä½ ä¹Ÿå¯ä»¥è‡ªå¸¦è¿è¡Œæ—¶å‘å¸ƒ, æ„Ÿè°¢GCC Runtime Library Exception[2], å³ä½¿ç§æœ‰è½¯ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„.&lt;/p&gt;

&lt;p&gt;ä¸ºä»€ä¹ˆGCCè¦è¿™ä¹ˆåšå‘¢? æˆ‘æ˜¯ä¸å¤§ç†è§£, å®˜æ–¹æ–‡æ¡£è¯´å› ä¸ºè¿™æ ·å°±ä¿è¯å¯ä»¥å’ŒC++11çš„ä»£ç é“¾æ¥äº†, &lt;strong&gt;å³ä½¿ä½ æ˜¾å¼æŒ‡å®šä½¿ç”¨è€æ ‡å‡†&lt;/strong&gt;, æƒŠä¸æƒŠå–œ?&lt;/p&gt;

&lt;h3 id=&quot;ref&quot;&gt;ref:&lt;/h3&gt;
&lt;p&gt;1, &lt;a href=&quot;https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html&quot;&gt;https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html&lt;/a&gt;&lt;br /&gt;
2, &lt;a href=&quot;https://www.gnu.org/licenses/gcc-exception-3.1.en.html&quot;&gt;https://www.gnu.org/licenses/gcc-exception-3.1.en.html&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 26 May 2017 16:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2017/05/understanding-_GLIBCXX_USE_CXX11_ABI/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2017/05/understanding-_GLIBCXX_USE_CXX11_ABI/</guid>
        
        
      </item>
    
      <item>
        <title>è‡ªåŠ¨å¤„ç†Makeçš„ä¾èµ–å…³ç³»</title>
        <description>&lt;h2 id=&quot;makeæ˜¯å¦‚ä½•å·¥ä½œçš„&quot;&gt;Makeæ˜¯å¦‚ä½•å·¥ä½œçš„&lt;/h2&gt;

&lt;p&gt;ç®€å•è¯´, Makefileä¸­æŒ‡å®šç›®æ ‡å’Œä¾èµ–, ç„¶åMakeè¿è¡Œçš„æ—¶å€™ä¼šæ£€æµ‹æ–‡ä»¶çš„æ—¶é—´ä¿¡æ¯, å¦‚æœç›®æ ‡è½åäºä¾èµ–çš„ä¿®æ”¹æ—¶é—´åˆ™ç›®æ ‡éœ€è¦é‡æ–°ç”Ÿæˆ, ä»¥æ­¤è¾¾åˆ°æŒ‰éœ€ç”Ÿæˆ, èŠ‚çœæ—¶é—´çš„ç›®çš„.&lt;/p&gt;

&lt;h2 id=&quot;å®é™…åœºæ™¯ä¸­çš„é—®é¢˜æ˜¯ä»€ä¹ˆ&quot;&gt;å®é™…åœºæ™¯ä¸­çš„é—®é¢˜æ˜¯ä»€ä¹ˆ&lt;/h2&gt;

&lt;p&gt;ä¸¾ä¸ªç®€å•çš„ä¾‹å­:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;OBJS := foo.o bar.o

program: $(OBJS)
	gcc $(OBJS) -o program

%.o: %.c
	gcc -c $(CFLAGS) $&amp;lt; -o $@
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªMakefileè¡¨è¾¾çš„æ„æ€æ˜¯ç”±&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;foo.c&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bar.c&lt;/code&gt;ç”Ÿæˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;program&lt;/code&gt;, ä¸­é—´ç›®æ ‡æ–‡ä»¶åˆ†åˆ«ä¾èµ–ç›¸åº”çš„æºæ–‡ä»¶. ä½†æ˜¯å®é™…åœºæ™¯è¿œæ²¡æœ‰è¿™ä¹ˆç®€å•, ä¾‹å¦‚æ¯ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.o&lt;/code&gt;è¿˜ä¼šå„è‡ªä¾èµ–å¾ˆå¤šä¸åŒçš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.h&lt;/code&gt;å¤´æ–‡ä»¶, æ€ä¹ˆåŠ? æŒ¨ä¸ªåˆ—å‡ºæ¥ä¹ˆ? å¤ªéº»çƒ¦äº†, è€Œä¸”ä¾èµ–å…³ç³»è¿˜å¯èƒ½ä¼šå˜åŒ–.&lt;/p&gt;

&lt;h2 id=&quot;ä¾èµ–å…³ç³»èƒ½è‡ªåŠ¨ç”Ÿæˆä¹ˆ&quot;&gt;ä¾èµ–å…³ç³»èƒ½è‡ªåŠ¨ç”Ÿæˆä¹ˆ&lt;/h2&gt;

&lt;p&gt;å½“ç„¶å¯ä»¥, ç›´æ¥çœ‹ä»£ç :&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;OBJS := foo.o bar.o

program: $(OBJS)
	gcc $(OBJS) -o program

-include $(OBJS:.o=.d)

%.o: %.c
	gcc -MD -MP -c $(CFLAGS) $&amp;lt; -o $@
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç›¸è¾ƒäºä¹‹å‰çš„ç‰ˆæœ¬, è¿™æ¬¡æ¯ä¸ª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.o&lt;/code&gt;çš„ç¼–è¯‘è¿‡ç¨‹ä¸­éƒ½ä¼šç”Ÿæˆä¸€ä¸ªMakefileè¯­æ³•çš„&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.d&lt;/code&gt;æ–‡ä»¶, é‡Œé¢åˆ—å‡ºäº†gccåˆ†æå¾—å‡ºçš„ä¾èµ–å…³ç³». æ‰€ä»¥å½“æˆ‘ä»¬æŠŠè¿™äº›&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.d&lt;/code&gt;æ–‡ä»¶åŒ…å«è¿›æ¥ä¹‹å, Makeå°±å¯ä»¥çŸ¥é“è¯¦ç»†çš„ä¾èµ–å…³ç³»ä¿¡æ¯, è¿›è€Œåˆ¤æ–­å“ªäº›ä¾èµ–å‘ç”Ÿäº†å˜åŒ–, å“ªäº›ç›®æ ‡éœ€è¦é‡æ–°ç”Ÿæˆ.&lt;/p&gt;

&lt;p&gt;PS, å¦‚æœä½ ä¸æƒ³æŠŠç³»ç»Ÿå¤´æ–‡ä»¶ä¹Ÿåˆ—åœ¨ä¾èµ–é‡Œé¢, å¯ä»¥æŠŠå‚æ•°&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-MD&lt;/code&gt;æ¢æˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-MMD&lt;/code&gt;.&lt;/p&gt;
</description>
        <pubDate>Sat, 30 Apr 2016 22:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2016/04/autodependencies-with-make/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2016/04/autodependencies-with-make/</guid>
        
        
      </item>
    
      <item>
        <title>Linuxä¸‹çš„æ€§èƒ½åˆ†æå·¥å…·: Perf</title>
        <description>&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯perf&quot;&gt;ä»€ä¹ˆæ˜¯Perf&lt;/h2&gt;

&lt;p&gt;Perfæ˜¯ä¸€ä¸ªä¸Linux Kernelç´§å¯†ç»“åˆçš„è½¯ä»¶æ€§èƒ½åˆ†æå·¥å…·.&lt;/p&gt;

&lt;h2 id=&quot;perfçš„å·¥ä½œåŸç†&quot;&gt;Perfçš„å·¥ä½œåŸç†&lt;/h2&gt;

&lt;p&gt;Perfçš„åŸºæœ¬åŸç†æ˜¯hookäº‹ä»¶, å¯¹è¢«åˆ†æå¯¹è±¡è¿›è¡Œé‡‡æ ·, è·å–æ•°æ®å¹¶åˆ†æ. ä¾‹å¦‚åœ¨æ—¶é’Ÿä¸­æ–­è§¦å‘æ—¶é‡‡æ ·contextå¯ä»¥åˆ†æå‡½æ•°çš„è¿è¡Œæ—¶é—´, åœ¨cache missè§¦å‘æ—¶é‡‡æ ·å¯ä»¥åˆ†æç¼“å­˜çš„å·¥ä½œæ•ˆç‡. æ­¤å¤–, Perfè¿˜æ”¯æŒç¼ºé¡µ, è¿›ç¨‹åˆ‡æ¢, å…·ä½“å†…æ ¸å‡½æ•°ç­‰äº‹ä»¶, å…·ä½“å¯ä»¥å‚è€ƒ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf list&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;perfæ€ä¹ˆç”¨&quot;&gt;Perfæ€ä¹ˆç”¨&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf stat ./a.out&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf stat -p 1234&lt;/code&gt;, åˆ†æç¨‹åºçš„æ•´ä½“æ€§èƒ½, å¯ä»¥çœ‹åˆ°ç¨‹åºçš„CPUä½¿ç”¨ç‡, è¿›ç¨‹åˆ‡æ¢æ¬¡æ•°, cacheåˆ©ç”¨æƒ…å†µç­‰ç­‰.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf top&lt;/code&gt;, ç±»ä¼¼topå‘½ä»¤, å¯ä»¥åˆ†ææ•´ä¸ªç³»ç»Ÿå½“å‰çš„çŠ¶æ€, ä¾‹å¦‚å¯»æ‰¾å½“å‰ç³»ç»Ÿæœ€è€—æ—¶çš„ç”¨æˆ·è¿›ç¨‹æˆ–è€…å†…æ ¸å‡½æ•°.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf record&lt;/code&gt;å’Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf report&lt;/code&gt;, å¯ä»¥è®°å½•å¹¶åˆ†æä¸€æ®µæ—¶é—´å†…çš„æ€§èƒ½äº‹ä»¶.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;perf --help&lt;/code&gt; :)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;happy-Ï€-day&quot;&gt;Happy Ï€ day!&lt;/h2&gt;

&lt;p&gt;è¿™åªæ˜¯ç¯‡ç®€ä»‹, ä¸»æ—¨æ˜¯è¦è¯´æ˜Perfå¾ˆå¼ºå¤§å¾ˆæ˜“ç”¨&lt;del&gt;ä»¥åŠæ›´æ–°ä¸€ä¸‹blog&lt;/del&gt;. å¦å¤–, åœ†å‘¨ç‡æ—¥å¿«ä¹!&lt;/p&gt;

&lt;h2 id=&quot;ref&quot;&gt;ref:&lt;/h2&gt;

&lt;p&gt;1, &lt;a href=&quot;https://perf.wiki.kernel.org/&quot;&gt;https://perf.wiki.kernel.org/&lt;/a&gt;&lt;br /&gt;
2, &lt;a href=&quot;http://www.brendangregg.com/perf.html&quot;&gt;http://www.brendangregg.com/perf.html&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 14 Mar 2016 15:09:26 +0800</pubDate>
        <link>http://adam8157.info/blog/2016/03/linux-profiler-perf/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2016/03/linux-profiler-perf/</guid>
        
        
      </item>
    
      <item>
        <title>é¾Ÿå…”ç®—æ³•ä¸ºä»€ä¹ˆæœ‰æ•ˆ</title>
        <description>&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯é¾Ÿå…”ç®—æ³•&quot;&gt;ä»€ä¹ˆæ˜¯é¾Ÿå…”ç®—æ³•&lt;/h2&gt;

&lt;p&gt;æ£€æµ‹å•é“¾è¡¨ä¸Šçš„ç¯æœ‰ä¸ªå¾ˆç»å…¸çš„ç®—æ³•å«åšâ€å¼—æ´›ä¼Šå¾·åˆ¤åœˆç®—æ³•â€, ä¹Ÿå«â€é¾Ÿå…”ç®—æ³•â€.&lt;/p&gt;

&lt;h2 id=&quot;é¾Ÿå…”ç®—æ³•çš„åŸºæœ¬æ€è·¯&quot;&gt;é¾Ÿå…”ç®—æ³•çš„åŸºæœ¬æ€è·¯&lt;/h2&gt;

&lt;h3 id=&quot;æ˜¯å¦æœ‰ç¯&quot;&gt;æ˜¯å¦æœ‰ç¯&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬è®©é¾Ÿ(tortoise)å’Œå…”(hare)ä»å•é“¾è¡¨çš„èµ·ç‚¹å‡ºå‘, æ¯æ¬¡é¾Ÿèµ°ä¸€æ­¥, å…”èµ°ä¸¤æ­¥, å¦‚æœtime_aæ­¥ä¹‹åé¾Ÿå…”ç›¸é‡, åˆ™è¯¥é“¾è¡¨æœ‰ç¯.&lt;/p&gt;

&lt;h3 id=&quot;ç¯çš„é•¿åº¦&quot;&gt;ç¯çš„é•¿åº¦&lt;/h3&gt;

&lt;p&gt;ä¸Šè¿°ç®—æ³•åˆšåˆ¤æ–­å‡ºå­˜åœ¨ç¯æ—¶, é¾Ÿå’Œå…”ä½äºåŒä¸€èŠ‚ç‚¹. æ­¤æ—¶è®©å…”ä¸åŠ¨, è€Œé¾Ÿä¸æ–­å‰è¿›, è‚¯å®šåˆä¼šç›¸é‡, è€Œè¿™ä¸€æ¬¡é¾Ÿå‰è¿›çš„æ­¥æ•°æ˜¾ç„¶å°±æ˜¯ç¯çš„é•¿åº¦length.&lt;/p&gt;

&lt;h3 id=&quot;ç¯çš„èµ·ç‚¹&quot;&gt;ç¯çš„èµ·ç‚¹&lt;/h3&gt;

&lt;p&gt;è¿˜æ˜¯ä¹‹å‰æ‰€è¯´é¾Ÿå…”ç›¸é‡çš„èŠ‚ç‚¹, é¦–å…ˆå…”ä¿æŒåŸä½, è€ŒæŠŠé¾Ÿç½®å›é“¾è¡¨èµ·ç‚¹, ç„¶åé¾Ÿå’Œå…”åŒæ—¶èµ°, æ¯æ¬¡éƒ½èµ°ä¸€æ­¥, ç»è¿‡time_bæ­¥æœ€ç»ˆå†æ¬¡ç›¸é‡, åˆ™è¿™æ¬¡ç›¸é‡çš„èŠ‚ç‚¹å°±æ˜¯ç¯çš„èµ·ç‚¹start.&lt;/p&gt;

&lt;h2 id=&quot;é¾Ÿå…”ç®—æ³•ä¸ºä»€ä¹ˆæœ‰æ•ˆ&quot;&gt;é¾Ÿå…”ç®—æ³•ä¸ºä»€ä¹ˆæœ‰æ•ˆ&lt;/h2&gt;

&lt;p&gt;å‡è®¾å…”æ¯æ¬¡èµ°stepæ­¥, é‚£ä¹ˆåªè¦å•é“¾è¡¨ä¸­å­˜åœ¨ç¯, è€Œä¸”é¾Ÿåˆ°è¾¾ç¯çš„èµ·ç‚¹ä¹‹å, é¾Ÿå’Œå…”ä¹‹é—´çš„è·¯ç¨‹å·®èƒ½å¤Ÿæ˜¯ç¯é•¿åº¦lengthçš„æ•´æ•°å€, åˆ™äºŒè€…å°±èƒ½ç›¸é‡. å³:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;((step - 1) * time_a) % length == 0  &amp;amp;&amp;amp; time_a &amp;gt;= start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­startå’Œlengthæ˜¯å›ºå®šçš„, time_aå´æ— é™å¢é•¿, æ‰€ä»¥æ€»ä¼šæœ‰æœºä¼šæ•´é™¤, æ‰€ä»¥é¾Ÿå…”ç®—æ³•å¯ä»¥åˆ¤æ–­æ˜¯å¦æœ‰ç¯.&lt;/p&gt;

&lt;p&gt;ç•¥è¿‡æ˜¾è€Œæ˜“è§çš„é•¿åº¦è®¡ç®—, æ¥ç€è¯´æŸ¥æ‰¾ç¯çš„èµ·ç‚¹. å½“ä»…å½“stepä¸º2, å³å…”æ¯æ¬¡èµ°ä¸¤æ­¥æ—¶, æ ¹æ®å‰é¢çš„æ¡ä»¶å¾—çŸ¥time_aèƒ½è¢«lengthæ•´é™¤. äºæ˜¯æˆ‘ä»¬æ¥ç€å‡è®¾time_bä¸ºé¾Ÿåˆ°è¾¾ç¯çš„èµ·ç‚¹startåç»•äº†nåœˆå†æ¬¡åˆ°è¾¾èµ·ç‚¹, å³&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;time_b == start + n * length&lt;/code&gt;, åˆ™å…”æ­¤æ—¶çš„ä½ç½®(å‡è®¾ç»•äº†måœˆ)æ˜¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;time_a + time_b - m * length&lt;/code&gt;, ä»£å…¥åä¸º&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;time_a + start + (n - m) * length&lt;/code&gt;, å› ä¸ºstepä¸º2æ—¶time_aèƒ½è¢«lengthæ•´é™¤, æ‰€ä»¥å…”æ­¤æ—¶æ­£å¥½ä¹Ÿåœ¨èµ·ç‚¹startå¤„, æ‰€ä»¥é¾Ÿå…”ç®—æ³•å¯ä»¥æ‰¾åˆ°ç¯çš„èµ·ç‚¹.&lt;/p&gt;
</description>
        <pubDate>Mon, 31 Aug 2015 20:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2015/08/why-does-tortoise-and-hare-algorithm-work/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2015/08/why-does-tortoise-and-hare-algorithm-work/</guid>
        
        
      </item>
    
      <item>
        <title>Hybrid bootable USB stick for legacy BIOS &amp; UEFI</title>
        <description>&lt;p&gt;This is a simple note for people who are googling this topic right now, and you are welcome.&lt;/p&gt;

&lt;h2 id=&quot;backgrounds&quot;&gt;Backgrounds&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Legacy BIOS needs bootloaders to be installed into MBR and the reserved space after it.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;UEFI only needs bootloaders in ESP(EFI System Partition).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;There is no resource competition between legacy BIOS and UEFI requirements.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;preparations&quot;&gt;Preparations&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;grub-pc-bin and grub-efi-amd64-bin packages for Debian users.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;An USB storage stick, MBR or GPT. Some unallocated space(1MB is enough) at the beginning of disk if you are using GPT.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;A vfat partition with the â€œbootâ€ flag.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cooking&quot;&gt;Cooking&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mount /dev/sdb1 /media/sdb1

# grub-install --target=i386-pc --boot-directory=/media/sdb1/boot /dev/sdb

# grub-install --target=x86_64-efi --efi-directory=/media/sdb1/ --boot-directory=/media/sdb1/boot --removable /dev/sdb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;configurationjust-a-template&quot;&gt;Configuration(just a template)&lt;/h2&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# /media/sdb1/boot/grub/grub.cfg
set root=(hd0,1)

menuentry &quot;FreeDOS&quot; {
        linux16  /boot/freedos/memdisk
        initrd16 /boot/freedos/balder10.img
}
menuentry &quot;Memtest86+&quot; {
        loopback loop /boot/systemrescuecd-x86-x.y.z.iso
        linux16 (loop)/bootdisk/memtestp
}
menuentry &quot;Ubuntu xx.yy&quot; {
        set isofile=&quot;/boot/ubuntu-xx.yy-desktop-amd64.iso&quot;
        loopback loop $isofile
        linux (loop)/casper/vmlinuz.efi boot=casper iso-scan/filename=$isofile noprompt noeject
        initrd (loop)/casper/initrd.lz
}
menuentry &quot;SystemRescueCd&quot; {
        set isofile=&quot;/boot/systemrescuecd-x86-x.y.z.iso&quot;
        loopback loop $isofile
        linux   (loop)/isolinux/rescue64 docache isoloop=$isofile
        initrd  (loop)/isolinux/initram.igz
}
menuentry &quot;Install Debian GNU/Linux&quot; {
        linux   /boot/debian/vmlinuz priority=low recommends=false
        initrd  /boot/debian/initrd.gz
}
menuentry &quot;Debian GNU/Linux Rescue Mode&quot; {
        linux   /boot/debian/vmlinuz priority=low recommends=false rescue/enable=true
        initrd  /boot/debian/initrd.gz
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Done, enjoy fixing othersâ€™ computers then, which I already quit :D&lt;/p&gt;
</description>
        <pubDate>Sun, 26 Apr 2015 20:00:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2015/04/hybrid-bootable-usb-stick-for-uefi-and-legacy-bios/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2015/04/hybrid-bootable-usb-stick-for-uefi-and-legacy-bios/</guid>
        
        
      </item>
    
      <item>
        <title>ä½¿ç”¨GNU GLOBALç´¢å¼•ä»£ç </title>
        <description>&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯global&quot;&gt;ä»€ä¹ˆæ˜¯GLOBAL&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.gnu.org/software/global/&quot;&gt;GLOBAL&lt;/a&gt;æ˜¯GNUå‡ºå“çš„ä¸€æ¬¾ä»£ç ç´¢å¼•å·¥å…·.&lt;/p&gt;

&lt;h2 id=&quot;globalæœ‰ä»€ä¹ˆä¼˜ç‚¹&quot;&gt;GLOBALæœ‰ä»€ä¹ˆä¼˜ç‚¹&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;åŸç”Ÿæ”¯æŒC, C++, æ±‡ç¼–ç­‰6ç§è¯­è¨€çš„ä»£ç ç´¢å¼•, å€ŸåŠ©æ’ä»¶æ”¯æŒçš„æ›´å¤šè¾¾25ç§&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ”¯æŒå¤šç§æŸ¥æ‰¾åŠŸèƒ½, ä¾‹å¦‚æœ€å¸¸ç”¨çš„æŸ¥æ‰¾å®šä¹‰, è°ƒç”¨å’Œæ–‡ä»¶ä½ç½®ç­‰&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æä¾›gtags-cscopeå‘½ä»¤, å…¼å®¹cscope&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç›¸å¯¹äºcscope, æŸ¥æ‰¾åŒ¹é…æ›´åŠ å¿«é€Ÿå’Œå‡†ç¡®&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ”¯æŒå¢é‡æ›´æ–°, è€Œä¸”æ¯”cscopeçš„å¢é‡æ›´æ–°å¿«å¾ˆå¤šå¾ˆå¤š&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å¼€å‘æ´»è·ƒ, ä¸Šä¸€æ¬¡å‘å¸ƒæ–°ç‰ˆæœ¬æ˜¯ä¸¤ä¸ªæœˆå‰, è€Œcscopeçš„ä¸Šä¸€æ¬¡æ˜¯ä¸¤å¹´å‰&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;å¦‚ä½•ä½¿ç”¨global&quot;&gt;å¦‚ä½•ä½¿ç”¨GLOBAL&lt;/h2&gt;

&lt;p&gt;ç®€å•è®², åœ¨ä»£ç ç›®å½•ä¸­æ‰§è¡Œ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gtags -i&lt;/code&gt;å»ºç«‹ç´¢å¼•æ•°æ®åº“, ç„¶åä½¿ç”¨globalå‘½ä»¤æŸ¥æ‰¾åŒ¹é…. ä¾‹å¦‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;global symbol&lt;/code&gt;æŸ¥çœ‹symbolçš„å®šä¹‰, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;global -r symbol&lt;/code&gt;æŸ¥çœ‹symbolåœ¨å“ªè¢«å¼•ç”¨, ç­‰ç­‰. è¯¦è§: &lt;a href=&quot;https://www.gnu.org/software/global/globaldoc_toc.html&quot;&gt;https://www.gnu.org/software/global/globaldoc_toc.html&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;vimä¸­ä½¿ç”¨globalçš„å°æŠ€å·§&quot;&gt;Vimä¸­ä½¿ç”¨GLOBALçš„å°æŠ€å·§&lt;/h2&gt;

&lt;p&gt;ç»§æ‰¿Vimä¸­cscopeçš„æ¥å£å’Œé”®ç»‘å®š:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;:set cscopeprg=gtags-cscope
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è‡ªåŠ¨ä»å½“å‰æ–‡ä»¶å¤¹é€’å½’å‘ä¸Šæœç´¢ç´¢å¼•æ•°æ®åº“å¹¶åŠ è½½:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;function! LoadDatabase()
	let db = findfile(&quot;GTAGS&quot;, &quot;.;&quot;)
	if (!empty(db))
		set nocscopeverbose
		exe &quot;cs add &quot; . db
		set cscopeverbose
	endif
endfunction
autocmd BufEnter *.[ch] call LoadDatabase()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sun, 23 Nov 2014 21:30:00 +0800</pubDate>
        <link>http://adam8157.info/blog/2014/11/use-gnu-global-for-source-code-tagging/</link>
        <guid isPermaLink="true">http://adam8157.info/blog/2014/11/use-gnu-global-for-source-code-tagging/</guid>
        
        
      </item>
    
  </channel>
</rss>
